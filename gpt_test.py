import os
from openai import OpenAI

client = OpenAI(
    api_key="sk-HiWS4YyjxDSu2a9xQiFJXP1GUwTuD04E54bpe9HHLYUyNyvy",
    base_url="https://api.lkeap.cloud.tencent.com/v1",
)

messages=[
        {
            'role': 'user', 
            'content': '''
            作为专业的财务分类助手，请根据以下要求分析交易记录：

            【任务要求】
            1. 输入格式：交易名称字符串（可能含商户/平台/订单号）
            2. 输出格式：严格合法的JSON对象，键为原始交易名称，值从预定义类型中选择
            3. 分类标准：
            - 餐饮：包含"餐厅、饭店、咖啡、快餐、汉堡、奶茶"等关键词
            - 下馆子：明确出现"餐馆、酒楼、饭店"等场所名称
            - 出行：涉及"地铁、公交、出租车、加油站、ETC"等交通场景
            - 购物：含"超市、商场、便利店、旗舰店"等零售场景
            - 医疗：包含"医院、诊所、药房"等关键词
            - 旅游：涉及"酒店、景区、旅行社"等场景
            - 其他类型根据关键词精确匹配

            【预定义类型】
            ["租房","大额支出","婚礼","出行","餐饮","水电费","下馆子","购物","医疗","宠物","快递","衣服鞋子","美容美发","日用百货","旅游","其他"]

            【处理规则】
            1. 忽略订单号、交易号等数字序列（如-25012511100400001308049884713091）
            2. 优先匹配最长有效商户名（如"塔斯汀·中国汉堡(惠新东桥店)"保留，"美团App"作为平台信息忽略）
            3. 金额特征不作为分类依据
            4. 无法确定时归为"其他"

            【示例】
            输入："塔斯汀·中国汉堡(惠新东桥店)-美团App-25012511100400001308049884713091","北京地铁","永辉超市(中关村店)消费386元","国大药房#6241"
            输出：
            {
            "塔斯汀·中国汉堡(惠新东桥店)-美团App-25012511100400001308049884713091": "餐饮",
            "北京地铁": "出行",
            "永辉超市(中关村店)消费386元": "购物",
            "国大药房#6241": "医疗"
            }

            请保持输出为合法JSON，不要包含任何额外内容。
            你需要分析的交易记录如下：
        '''
        }
    ]


completion = client.chat.completions.create(
    model="deepseek-v3",
    messages=messages
    )
# 通过content字段打印最终答案
print("最终答案：")
print(completion.choices[0].message.content)